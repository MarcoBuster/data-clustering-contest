<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://ko.com.ua/rabota_odnosoketnym_serveram_130895"/>
    <meta property="og:site_name" content="Компьютерное Обозрение"/>
    <meta property="article:published_time" content="2019-11-15T00:00:00+00:00"/>
    <meta property="og:title" content="Работа односокетным серверам"/>
    <meta property="og:description" content="Серия AMD EPYC 7002P прокладывает дорогу в односокетное будущее серверов. Выход линейки процессоров AMD EPYC 7002 (Rome) перекроил карту серверного рынка. С охватом от 8 до 64 физических ядер (16 ... 128 логических), при 4 ТБ оперативной памяти и 128 линиях PCIe одним таким CPU можно решать задачи, прежде требовавшие 2- и 4-процессорных систем."/>
  </head>
  <body>
    <article>
      <h1>Работа односокетным серверам</h1>
      <address><time datetime="2019-11-15T00:00:00+00:00">15 Nov 2019</time> by <a rel="author" href="https://ko.com.ua/user/226" target="_blank">Юрий Жуковский</a></address>
      <p>
        <i>Серия AMD EPYC 7002P прокладывает дорогу в односокетное будущее серверов. Выход линейки процессоров AMD EPYC 7002 (Rome) перекроил карту серверного рынка. С охватом от 8 до 64 физических ядер (16 ... 128 логических), при 4 ТБ оперативной памяти и 128 линиях PCIe одним таким CPU можно решать задачи, прежде требовавшие 2- и 4-процессорных систем.</i>
      </p>
      <p>Так, два процессора Intel Xeon Gold 6262 проигрывают одному AMD EPYC 7702P (и это еще без учета обвязки):</p>
      <figure>
        <img src="https://ko.com.ua/files/u5101/one-7002.png"/>
      </figure>
      <p>
        <a href="https://sqlperformance.com/2019/08/sql-performance/amd-epyc-7002-sql-server">
          <i>Источник</i>
        </a>
      </p>
      <h3>Тесты</h3>
      <p>Для оценки реальной производительности обратимся к официально опубликованным данным.</p>
      <p>HPE представила результат двух своих серверных платформ в тесте <a href="http://www.tpc.org/tpch/results/tpch_result_detail.asp?id=119080501">TPC-H SQL Server 2017</a>. Однопроцессорный HPE Proliant DL325 Gen10 на AMD EPYC 7502P и 512 ГБ оперативной памяти <a href="https://buy.hpe.com/us/en/servers/rack-servers/proliant-dl300-servers/proliant-dl325-server/hpe-proliant-dl325-gen10-server/p/1010868976">показал</a> 743,750 QphH@1000GB. Если разделить 743 750 на 32 ядра, получим 23 242 на ядро. Цена за QphH для этой системы составляет 0,34 долларов США.</p>
      <p><a href="http://www.tpc.org/tpch/results/tpch_result_detail.asp?id=117111701">Результат TPC-H</a> двухпроцессорного сервера HPE Proliant DL380 Gen 10 равен 1,009,065 QphH@1000GB. Это более высокий показатель, но в данной системе использовались два 28-ядерных процессора Intel Xeon Platinum 8180 (всего 56C / 112T) и 512 ГБ оперативной памяти. Если мы разделим 1 009 065 на 56 ядер, получим 18 019 на ядро. Цена за QphH для этой системы составляет 0,47 долларов США.</p>
      <p>Результатами в тесте <a href="http://www.tpc.org/tpce/results/tpce_result_detail.asp?id=119080201">TPC-E SQL Server 2017</a> поделилась Lenovo. Тестирование пропускной способности TPC-E — хороший показатель общей загрузки CPU для рабочей нагрузки OLTP. Однопроцессорный сервер ThinkSystem SR655 2U <a href="https://www.lenovo.com/us/en/data-center/servers/racks/ThinkSystem-SR655/p/77XX7SRSR75">выдал значение</a> 6 716,88. В нем один 64-ядерный процессор AMD EPYC 7742 и 1 ТБ оперативной памяти. Однопоточная производительность в расчете на одно ядро составляет 6716,88 / 64 = 104,95.</p>
      <p>Двухпроцессорный сервер Lenovo ThinkSystem SR650 2U <a href="https://www.lenovo.com/us/en/data-center/servers/racks/ThinkSystem-SR650/p/77XX7SRSR65">вышел на показатель</a> 7012,53. В нем два 28-ядерных процессора Intel Xeon Platinum 8280 и 1,5 ТБ оперативной памяти. Если мы разделим 7012,53 на 56, оценка на ядро составит 125,22, что примерно на 19% выше результата AMD.</p>
      <p>Из этого теста следует, что однопоточная производительность процессора — не самое сильное место процессора AMD EPYC 7742. Но при этом общая производительность обеих систем находится приблизительно на одном уровне (разрыв около 5%), при объеме оперативной памяти на 50% меньше.</p>
      <p>Показатели односокетных систем на процессорах AMD EPYC 7002P от двух различных производителей в столь тяжелом приложении как SQL наглядно демонстрируют достаточную вычислительную мощность, пропускную способность памяти, а также пропускную способность подсистем ввода/вывода для поддержания сервером больших нагрузок.</p>
      <h3>Практика. Роли однопроцессорных серверов</h3>
      <p>Корпоративный рынок консервативен. Двухсокетные системы пока остаются стандартом массового рынка, фаворитом дата-центров и основой публичных облаков. Но есть много классов приложений, где подходы меняются на глазах.</p>
      <p>
        <b>Cерверы баз данных</b>
      </p>
      <p>Для приложений, работающих с базами данных, важно не максимально быстрое обслуживание одного потока запросов, а способность поддерживать большое количество множественных обращений. Эта задача эффективно решается ростом числа ядер CPU, расширением каналов доступа к оперативной памяти и устройствам ввода/вывода, снижением задержек на них. Уступая в производительности системам на двух Intel Xeon Platinum 8280, AMD EPYC 7742 компенсирует это ядрами. При куда меньшей цене.</p>
      <p>Если говорить о практически востребованной мощности, то в ERP-системах одного логического ядра процессора хватает 20-30 пользователям. Чтобы загрузить 128 логических ядер старшего 64-ядерного AMD EPYC 7702P, надо одновременно обслуживать 2500-4000 пользователей. Это очень много, особенно в украинских реалиях. А значит, можно обойтись более дешевыми AMD EPYC 7502 (32 ядра), 7402P (24 ядра) или 7302P (16 ядер).</p>
      <p>
        <b>Хостинг виртуальных машин</b>
      </p>
      <p>Операторы практикуют оверселлинг — продажу услуг сверх имеющихся физических ресурсов. 64 физических ядра и 4 ТБ оперативной памяти односокетного сервера дают им огромное поле маневра. Концентрировать мощности сверх этого на одном хосте было бы рискованно — из-за высокой цены простоя в случае программного или аппаратного сбоя. А еще, если ПО лицензируется посокетно (как VMware VSAN), однопроцессорные серверы сокращают капитальные затраты.</p>
      <p>
        <b>Гиперконвергенция</b>
      </p>
      <p>В гиперконвергентной инфраструктуре (HCI) вычисления, распределённое хранение и скоростной доступ к данным с низкой латентностью реализованы на однородном кластере серверов с локальными дисками. Так работают крупные промышленные облачные провайдеры, так устроены частные облака передовых предприятий. Эффективность похода наглядно демонстрирует рост рыночной доли Microsoft Azure и ее расширения для ЦОД, Azure Stack. Популярны пакетные решения Nutanix, Dell VxRail, HPE SimpliVity. Хорошо документирована процедура построения HCI-кластера на типовых серверах по технологии Microsoft Storage Spaces Direct. При высокой вычислительной мощности односокетных серверов на AMD EPYC 7002P и их небольшой цене такая инфраструктура получается доступной и эластичной.</p>
      <p>
        <b>Выгрузка данных, аналитика, отчеты</b>
      </p>
      <p>SQL Server DW/Reporting — отдельный пласт приложений, требующих большого количества вычислительных ядер, много оперативной памяти, просторных каналов ввода/вывода. Однопроцессорное решение на AMD EPYC 7002P выглядит даже привлекательнее двухпроцессорных систем на Intel Xeon. Поддерживается стандарт PCIe 4.0 подключения скоростной периферии. В платформу 2U/24×2.5″ можно поставить хоть все NVMe SSD, и каждый из них получит свои выделенные четыре линии PCIe от CPU (в двухпроцессорном сервере на Intel Xeon доступ к такому количеству NVMe коммутированный — с дополнительными затратами и задержками).</p>
      <p>
        <b>Программно-определяемое хранение</b>
      </p>
      <p>Специализированное программное обеспечение превращает типовые серверы в системы хранения (SDS) — при условии, что есть запас по вычислительным ядрам, оперативной памяти, каналам дискового и сетевого ввода/вывода. Вкупе с сервисными процедурами, объемное хранение (особенно, распределенное) порождает большое количество операций с данными и метаданными (кэширование, балансировка и синхронизация данных на узлах, восстановление после сбоев, многопоточные обмены по сетевым интерфейсам). На все это нужны процессорные ядра и оперативная память. Интеграторы многих SDS (например, Ceph) придерживаются простого правила: 1ГБ оперативной памяти на 1ТБ полезных данных. Серверам-контроллерам хранилищ петабайт-уровня не нужны два процессора Intel Xeon, достаточно одного AMD EPYC 7002P.</p>
      <p>
        <b>Рынок рассудит</b>
      </p>
      <p>Специализацией движет выгода, а не традиции. Если уж <a href="https://aws.amazon.com/ru/ec2/amd">AWS адаптировал часть сервисов Amazon EC2</a> с оглядкой на возможности AMD EPYC, то землянам и подавно пора. Попутно обязывает <a href="https://www.gartner.com/doc/reprints?id=1-680TWAA&amp;ct=190212&amp;st=sb">прогноз Gartner</a>, что к 2021-му году односокетные серверы х86 будут справляться с 80% нагрузок в дата-центрах, против 20% в 2018. В кои то веки AMD формирует серверную повестку.</p>
      <p>
        <b>Вы можете подписаться на наш <a href="https://t.me/ko_ua">Telegram-канал</a> для получения наиболее интересной информации</b>
      </p>
      <related>
        <h4>Читайте также</h4>
        <a href="https://ko.com.ua/dorozhnye_karty_v_odnosoketnoe_budushhee_serverov_129983"/>
        <a href="https://ko.com.ua/odnosoketnye_kirpichiki_servernoj_infrastruktury_129741"/>
        <a href="https://ko.com.ua/servernyj_specnaz_129159"/>
        <a href="https://ko.com.ua/intel_neset_thunderbolt_v_massy_129022"/>
        <a href="https://ko.com.ua/odnosoketnoe_budushhee_serverov_128794"/>
      </related>
    </article>
  </body>
</html>